# name: test/sql/union.test
# description: test lineage capture and querying (union)
# group: [sql]


require lineage

statement ok
LOAD lineage;

statement ok
CREATE TABLE t (id INTEGER, val INTEGER);

statement ok
INSERT INTO t VALUES
    (1, 10),
    (2, 20),
    (3, 30);

statement ok
PRAGMA set_lineage(True);

query II
SELECT * FROM t as t1 UNION ALL SELECT * FROM t as t2
----
1	10
2	20
3	30
1	10
2	20
3	30

statement ok
PRAGMA set_lineage(False);


statement ok
PRAGMA PrepareLineage(0);

query I
SELECT * FROM read_block(0);
----

statement ok
PRAGMA clear_lineage;

